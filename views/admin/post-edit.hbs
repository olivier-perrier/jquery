{{#> admin/content}}

<div class="border rounded mt-3 p-1 d-flex justify-content-between">
    <a href="/admin/posts" class="btn btn-light">Return</a>
    <div>
        <button class="btn btn-success mx-3" type="button" onClick="postSave('{{post._id}}')">Save</button>
        <a href="/posts/{{post._id}}" class="btn btn-primary mr-3">View</a>
        <button onClick="deletePost('{{_id}}')" class="btn btn-danger btn-sm">Delete</button>
    </div>
</div>

<div class="my-3">

    <!-- Title -->
    <div class="input-group input-group-lg mb-3">
        <input type="text" class="form-control" id="postTitle" value="{{post.title}}" placeholder="Post title">
    </div>

    <!-- Name -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Name</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="postName" value="{{post.name}}">
            <small id="emailHelp" class="form-text text-muted">Name is used for url.</small>
        </div>
    </div>

    <!-- Status -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Status</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="postStatus" value="{{post.status}}">
            <small id="emailHelp" class="form-text text-muted">Status of the post (draft, publish, trash).</small>
        </div>
    </div>

    <!-- Image -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Image</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="postImage" value="{{post.image}}">
            <small id="emailHelp" class="form-text text-muted">Name of the image to use for this post.</small>
        </div>
    </div>

    <!-- Content -->
    <div class="form-group">
        <label>Content</label>
        <textarea id="postContent" rows="20" class="form-control" placeholder="Content">{{post.content}}</textarea>
    </div>

    <!-- Description -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Description</label>
        <div class="col-sm-10">
            <textarea class="form-control" id="postDescription" rows="3">{{post.description}}</textarea>
            <small id="emailHelp" class="form-text text-muted">Write an optional description.</small>
        </div>
    </div>

    <!-- Categories -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Categories</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="postCategory" value="{{post.category}}">
            <small id="emailHelp" class="form-text text-muted">Category of the post.</small>
        </div>
    </div>

    <!-- Format -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Format</label>
        <div class="col-sm-10">
            <input type="text" class="form-control mb-1" id="postFormat" value="{{post.format}}">
            <select class="custom-select" id="postFormat">
                <option value="audio">Audio</option>
                <option value="default">Default</option>
                <option value="link">Link</option>
                <option value="text">Text</option>
                <option value="video">Video</option>
            </select>
        </div>
    </div>

    <!-- Tags -->
    <div class="form-group row">
        <label class="col-sm-2 col-form-label">Tags</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" id="postTags" value="{{post.tags}}">
            <small id="emailHelp" class="form-text text-muted">Labels linked to the content.</small>
        </div>
    </div>

    <span class="text-muted">Created {{toSimpleDate post.createdAt}}</span>
    <br>
    <span class="text-muted">Updated {{toSimpleDate post.updatedAt}}</span></td>


</div>


{{/ admin/content}}


<script>

    function postSave(postId) {

        var post = {
            title: $('#postTitle').val(),
            name: $('#postName').val(),
            image: $('#postImage').val(),
            content: $('#postContent').val(),
            description: $('#postDescription').val(),
            category: $('#postCategory').val(),
            format: $('#postFormat').val(),
            tags: $('#postTags').val(),
            status: $('#postStatus').val(),
        }

        $.post(URL + "/API/posts/save", { id: postId, post: post }, (data, statut) => {
            console.log(data)
            window.location = "/admin/posts/edit/" + postId
        })

    }

    function deletePost(postId) {
        $.post(URL + "/API/posts/delete/", { id: postId }, (data, statut) => {
            console.log(data)
            window.location = "/admin/posts"
        })
    }


</script>

<style>
    table th,
    td {
        padding-bottom: .75rem;
        padding-right: .75rem
    }
</style>